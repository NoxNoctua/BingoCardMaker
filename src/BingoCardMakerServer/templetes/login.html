<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>{{ page_title }}</title>
	<link rel="stylesheet" href="{{ url_for('static', path='root_style.css') }}">
</head>

<body>
	<script>
		// Code to run once window is finished loading
		window.onload = function() {
			console.log("Script Start")
			const loginForm = document.querySelector("#loginform");

			var token = ""

			loginForm.addEventListener("submit", async() => {
				event.preventDefault();

				console.log("Sending login")
				const formData = new FormData(loginForm);

				fetch("{{ domain_name }}/users/token", {
					method: "POST",
					body: formData,
				}).then( () => {
					document.location.href = "{{ domain_name }}/"
				});
			});
			const testBtn = document.querySelector("#testme");

			testBtn.addEventListener("click", async() => {
				const headers = {'Authorization': "bearer "+ token};
				const respone = await fetch("{{ domain_name }}/users/me", {
					
				})
				console.log(await respone.json());
			})

		}
	</script>
	{% include 'header.html' %}
	<div class="main_div_style">
		<form id="loginform" class="default_form_style" method="POST">
			<h1 class="large_title">Login</h1>
			<div class="input_div fixed_width_medium">
				<label class="medium_label">Email</label>
				<div class="spacer_div"></div>
				<input type="text" id="username_ti" required placeholder="Your username" , name="username">
			</div>
			<div class="input_div fixed_width_medium">
				<label class="medium_label">Password</label>
				<div class="spacer_div"></div>
				<input type="text" id="password-ti" requred placeholder="Password" name="password">
			</div>
			<button type="submit" class="small_button" id="login_btn">Login</button>
		</form>
		<div>
			<button id="testme" class="small_button">Test Me</button>
		</div>
	</div>
</body>

</html>